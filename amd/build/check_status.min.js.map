{"version":3,"file":"check_status.min.js","sources":["../src/check_status.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * TODO describe module check_status\n *\n * @module     paygw_fawry/check_status\n * @copyright  2024 Mohammad Farouk <phun.for.physics@gmail.com>\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\nimport Ajax from 'core/ajax';\nimport $ from 'jquery';\n\nlet orderId;\nlet successUrl;\n\n/**\n * Check the order status\n * @returns {Promise<Object>}\n */\nfunction checkStatus() {\n    let request = Ajax.call([{\n        methodname: 'paygw_fawry_check_status',\n        args: {\n            orderid: orderId\n        }\n    }]);\n    return request[0];\n}\n\nexport const init = (orderid, url) => {\n    orderId = orderid;\n    successUrl = url;\n    var interval = setInterval(async() => {\n        let response = await checkStatus();\n        if (response.status === 'success') {\n            clearInterval(interval);\n            window.location.href = successUrl;\n        } else if (response.status === 'failed') {\n            clearInterval(interval);\n        }\n        $('[data-purpose=\"status\"]').text(response.status);\n    }, 10000);\n};"],"names":["orderId","successUrl","orderid","url","interval","setInterval","async","response","Ajax","call","methodname","args","status","clearInterval","window","location","href","text"],"mappings":";;;;;;;SAyBIA,QACAC,kLAgBgB,CAACC,QAASC,OAC1BH,QAAUE,QACVD,WAAaE,QACTC,SAAWC,aAAYC,cACnBC,eAbMC,cAAKC,KAAK,CAAC,CACrBC,WAAY,2BACZC,KAAM,CACFT,QAASF,YAGF,GAQa,YAApBO,SAASK,QACTC,cAAcT,UACdU,OAAOC,SAASC,KAAOf,YACI,WAApBM,SAASK,QAChBC,cAAcT,8BAEhB,2BAA2Ba,KAAKV,SAASK,UAC5C"}